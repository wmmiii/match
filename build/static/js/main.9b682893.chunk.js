(this.webpackJsonpmatch=this.webpackJsonpmatch||[]).push([[0],[,,,,,,,,,function(t,e,n){t.exports=n(18)},,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var a=n(0),o=n.n(a),r=n(8),i=n.n(r),s=(n(14),n(2)),c=n(3),l=n(1),u=n(4),h=n(5),d={display:"none"},v=function(){return o.a.createElement("svg",{width:"64",height:"64",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:d},o.a.createElement("defs",null,o.a.createElement("g",{id:"alpha",fill:"none"},o.a.createElement("circle",{cx:"32",cy:"32",r:"24",stroke:"currentColor",strokeWidth:"4"}),o.a.createElement("circle",{cx:"32",cy:"32",r:"16",stroke:"currentColor",strokeWidth:"4"})),o.a.createElement("path",{id:"beta",d:"M48 12L16 52h32L16 12h32z",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),o.a.createElement("path",{id:"gamma",d:"M34 16a2 2 0 10-4 0h4zM8 38a2 2 0 100 4v-4zm48 4a2 2 0 100-4v4zm-5.59-17.59a2 2 0 10-2.82-2.82l2.82 2.82zm-34-2.82a2 2 0 10-2.82 2.82l2.82-2.82zM8 42h24v-4H8v4zm24 0h24v-4H32v4zm0-16c3.87 0 7.36 1.56 9.9 4.1l2.83-2.83A17.95 17.95 0 0032 22v4zm9.9 4.1A13.95 13.95 0 0146 40h4c0-4.97-2.02-9.47-5.27-12.73L41.9 30.1zm2.83 0l5.68-5.69-2.82-2.82-5.69 5.68 2.83 2.83zM18 40c0-3.87 1.56-7.36 4.1-9.9l-2.83-2.83A17.95 17.95 0 0014 40h4zm4.1-9.9A13.95 13.95 0 0132 26v-4c-4.97 0-9.47 2.02-12.73 5.27l2.83 2.83zm0-2.83l-5.69-5.68-2.82 2.82 5.68 5.69 2.83-2.83zM34 24v-8h-4v8h4z",fill:"currentColor"}),o.a.createElement("path",{id:"delta",d:"M32 12l1.41-1.41a2 2 0 00-2.82 0L32 12zM12 32l-1.41-1.41a2 2 0 000 2.82L12 32zm20 20l-1.41 1.41a2 2 0 002.82 0L32 52zm20-20l1.41 1.41a2 2 0 000-2.82L52 32zM30.59 10.59l-20 20 2.82 2.82 20-20-2.82-2.82zm-20 22.82l20 20 2.82-2.82-20-20-2.82 2.82zm22.82 20l20-20-2.82-2.82-20 20 2.82 2.82zm20-22.82l-20-20-2.82 2.82 20 20 2.82-2.82zM30 12v40h4V12h-4z",fill:"currentColor"})))};n(15);function p(t,e,n){var a=t[e];return null!=a?a[n]:void 0}function f(t,e,n,a){var o=t[e];null==o&&(t[e]={},o=t[e]),o[n]=a}function m(t,e){for(var n in t){var a=t[n];for(var o in a){var r=a[o];null!=r&&e(parseInt(n),parseInt(o),r)}}}n(16);var y=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).state={visible:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this;window.setTimeout((function(){t.setState({visible:!0})}),100)}},{key:"render",value:function(){var t=this,e=this.props.scale,n={color:this.props.color,height:e,left:this.props.x*e+"px",top:this.props.y*e+"px",width:e},a="#"+this.props.icon,r=["Piece"];return this.state.visible||r.push("hidden"),this.props.selected&&r.push("selected"),o.a.createElement("div",{className:r.join(" "),style:n,onMouseDown:function(e){return t.props.actionDown(e.nativeEvent)},onMouseMove:function(e){return t.props.actionMove(e.nativeEvent)},onMouseUp:this.props.actionUp,onTouchStart:function(e){return t.props.actionDown(e.nativeEvent)},onTouchMove:function(e){return t.props.actionMove(e.nativeEvent)},onTouchEnd:this.props.actionUp},o.a.createElement("svg",{width:"64",height:"64",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},o.a.createElement("use",{xlinkHref:a})))}}]),n}(o.a.Component),b={alpha:{type:"alpha",icon:"alpha",baseColor:"#0066FF"},beta:{type:"beta",icon:"beta",baseColor:"#FFB800"},gamma:{type:"gamma",icon:"gamma",baseColor:"#EB00FF"},delta:{type:"delta",icon:"delta",baseColor:"#00FFC2"}},S=(n(17),function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).boardRef=void 0,a.boardRef=o.a.createRef(),a.state={lastCoordinates:void 0},a.onStart=a.onStart.bind(Object(l.a)(a)),a.onMove=a.onMove.bind(Object(l.a)(a)),a.onEnd=a.onEnd.bind(Object(l.a)(a)),a}return Object(c.a)(n,[{key:"onStart",value:function(t){if(t instanceof MouseEvent)this.props.onStart(this.toGridSpace(t.clientX,t.clientY));else{var e=t.touches[0];this.props.onStart(this.toGridSpace(e.clientX,e.clientY))}}},{key:"onMove",value:function(t){if(t instanceof MouseEvent)this.setState({lastCoordinates:this.toGridSpace(t.clientX,t.clientY)});else{var e=t.touches[0];this.setState({lastCoordinates:this.toGridSpace(e.clientX,e.clientY)})}}},{key:"onEnd",value:function(){null!=this.state.lastCoordinates&&this.props.onEnd(this.state.lastCoordinates),this.setState({lastCoordinates:void 0})}},{key:"render",value:function(){var t=this,e=-1/0,n=1/0,a=-1/0,r=1/0,i=[];m(this.props.gameState.board,(function(t,s){var c={left:64*t+"px",top:64*s+"px"},l="".concat(t,",").concat(s);i.push(o.a.createElement("div",{className:"Board-cell",style:c,key:l})),e=Math.max(t,e),a=Math.max(s,a),n=Math.min(t,n),r=Math.min(s,r)}));var s=[];m(this.props.gameState.pieces,(function(e,n,a){var r=b[a.type],i=null!=t.state.lastCoordinates&&t.state.lastCoordinates.x===e&&t.state.lastCoordinates.y===n;s.push(o.a.createElement(y,{color:r.baseColor,icon:r.icon,id:a.id,key:a.id,scale:64,selected:i,x:e,y:n,actionDown:t.onStart,actionMove:t.onMove,actionUp:t.onEnd}))}));var c={width:64*(e-n+1)+"px",height:64*(a-r+1)+"px"};return o.a.createElement("div",{className:"Board",ref:this.boardRef,style:c},o.a.createElement("div",{className:"Board-grid"},i),o.a.createElement("div",{className:"Board-pieces"},s))}},{key:"toGridSpace",value:function(t,e){var n,a=null===(n=this.boardRef.current)||void 0===n?void 0:n.getBoundingClientRect(),o=null===a||void 0===a?void 0:a.left;if(null==o)throw Error("Could not get left of board ref!");var r=null===a||void 0===a?void 0:a.top;if(null==r)throw Error("Could not get top of board ref!");return{x:Math.floor((t-o)/64),y:Math.floor((e-r)/64)}}}]),n}(o.a.Component)),g=function(){function t(e,n,a,o){Object(s.a)(this,t),this.currentState=void 0,this.generator=void 0,this.allowedMoves=void 0,this.matchRules=void 0,this.currentState=e,this.generator=n,this.allowedMoves=a,this.matchRules=o.sort((function(t,e){return e.priority-t.priority}))}return Object(c.a)(t,[{key:"initialize",value:function(){for(console.time();!this.currentState.settled;)this.tick();this.currentState.score=0,console.timeEnd()}},{key:"move",value:function(t,e){var n=this;return!(!0!==this.currentState.settled||!this.allowedMoves.some((function(a){return a(t,e,n.currentState)})))&&(function(t,e,n,a,o){var r=p(t,e,n);f(t,e,n,p(t,a,o)),f(t,a,o,r)}(this.currentState.pieces,t.x,t.y,e.x,e.y),this.currentState.settled=!1,!0)}},{key:"tick",value:function(){var t=this,e=this.state,n=JSON.stringify(e),a=this.state,o=!0,r={};return m(a.board,(function(t,e){if(null==p(a.pieces,t,e))for(;null!=p(a.board,t,e);)f(r,t,e,!0),e-=1})),m(r,(function(n,r){null!=p(a.board,n,r-1)?f(a.pieces,n,r,p(e.pieces,n,r-1)):f(a.pieces,n,r,t.generator({x:n,y:r})),o=!1})),o&&this.matchRules.forEach((function(t){JSON.stringify(a);a=t.apply(a),JSON.stringify(a)})),a.settled=JSON.stringify(a)===n,this.currentState=a,Object.assign({},this.currentState)}},{key:"state",get:function(){return JSON.parse(JSON.stringify(this.currentState))}}]),t}(),E=n(20),x=Object.keys(b),M=function(){var t=Math.floor(Math.random()*x.length);return{id:Object(E.a)(),type:x[t]}},w=[function(t,e,n){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)===1&&(null!=p(n.pieces,t.x,t.y)&&null!=p(n.pieces,e.x,e.y))}],k=n(6);function O(t,e){for(var n=arguments.length,a=new Array(n>2?n-2:0),o=2;o<n;o++)a[o-2]=arguments[o];var r=t.pieces;return m(t.board,(function(n,o){var i=p(r,n,o);if(null!=i){var s,c=i.type,l=Object(k.a)(a);try{for(l.s();!(s=l.n()).done;){var u=s.value,h=p(r,n+u.x,o+u.y);if(null==h||h.type!==c)return}}catch(y){l.e(y)}finally{l.f()}var d,v=Object(k.a)(a);try{for(v.s();!(d=v.n()).done;){var m=d.value;f(t.pieces,n+m.x,o+m.y,void 0)}}catch(y){v.e(y)}finally{v.f()}t.score+=e}})),t}var j=[{priority:.1,apply:function(t){return O(t,300,{x:-3,y:0},{x:-2,y:0},{x:-1,y:0},{x:0,y:0}),t}},{priority:.1,apply:function(t){return O(t,300,{x:0,y:-3},{x:0,y:-2},{x:0,y:-1},{x:0,y:0}),t}},{priority:0,apply:function(t){return O(t,100,{x:-2,y:0},{x:-1,y:0},{x:0,y:0}),t}},{priority:0,apply:function(t){return O(t,100,{x:0,y:-2},{x:0,y:-1},{x:0,y:0}),t}}],z=function(t){Object(h.a)(n,t);var e=Object(u.a)(n);function n(t){var a;Object(s.a)(this,n),a=e.call(this,t);var o=new g({board:{0:{1:!0,2:!0,3:!0},1:{0:!0,1:!0,2:!0,3:!0,4:!0},2:{0:!0,1:!0,2:!0,3:!0,4:!0},3:{0:!0,1:!0,2:!0,3:!0,4:!0},4:{1:!0,2:!0,3:!0}},score:0,pieces:[],settled:!1},M,w,j);return o.initialize(),a.state={engine:o,gameState:o.state,start:void 0},a.onStart=a.onStart.bind(Object(l.a)(a)),a.onEnd=a.onEnd.bind(Object(l.a)(a)),a}return Object(c.a)(n,[{key:"onStart",value:function(t){return this.setState({start:t}),!1}},{key:"onEnd",value:function(t){var e=this,n=this.state.engine;if(null!=t&&null!=this.state.start&&n.state.settled&&n.move(this.state.start,t)){this.setState({gameState:n.state}),this.forceUpdate();var a=window.setInterval((function(){e.setState({gameState:n.tick()}),e.forceUpdate(),e.state.gameState.settled&&window.clearInterval(a)}),200)}return this.setState({start:void 0}),!1}},{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(v,null),o.a.createElement("div",{className:"score"},this.state.gameState.score),o.a.createElement(S,{gameState:this.state.gameState,onStart:this.onStart,onEnd:this.onEnd}))}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.9b682893.chunk.js.map