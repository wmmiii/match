(this.webpackJsonpmatch=this.webpackJsonpmatch||[]).push([[0],[,,,,,,,,,function(t,e,n){t.exports=n(18)},,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(8),i=n.n(o),s=(n(14),n(2)),c=n(3),l=n(1),u=n(4),d=n(5),h={display:"none"},v=function(){return r.a.createElement("svg",{width:"64",height:"64",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:h},r.a.createElement("defs",null,r.a.createElement("g",{id:"alpha",fill:"none"},r.a.createElement("circle",{cx:"32",cy:"32",r:"24",stroke:"currentColor",strokeWidth:"4"}),r.a.createElement("circle",{cx:"32",cy:"32",r:"16",stroke:"currentColor",strokeWidth:"4"})),r.a.createElement("path",{id:"beta",d:"M48 12L16 52h32L16 12h32z",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),r.a.createElement("path",{id:"gamma",d:"M34 16a2 2 0 10-4 0h4zM8 38a2 2 0 100 4v-4zm48 4a2 2 0 100-4v4zm-5.59-17.59a2 2 0 10-2.82-2.82l2.82 2.82zm-34-2.82a2 2 0 10-2.82 2.82l2.82-2.82zM8 42h24v-4H8v4zm24 0h24v-4H32v4zm0-16c3.87 0 7.36 1.56 9.9 4.1l2.83-2.83A17.95 17.95 0 0032 22v4zm9.9 4.1A13.95 13.95 0 0146 40h4c0-4.97-2.02-9.47-5.27-12.73L41.9 30.1zm2.83 0l5.68-5.69-2.82-2.82-5.69 5.68 2.83 2.83zM18 40c0-3.87 1.56-7.36 4.1-9.9l-2.83-2.83A17.95 17.95 0 0014 40h4zm4.1-9.9A13.95 13.95 0 0132 26v-4c-4.97 0-9.47 2.02-12.73 5.27l2.83 2.83zm0-2.83l-5.69-5.68-2.82 2.82 5.68 5.69 2.83-2.83zM34 24v-8h-4v8h4z",fill:"currentColor"}),r.a.createElement("path",{id:"delta",d:"M32 12l1.41-1.41a2 2 0 00-2.82 0L32 12zM12 32l-1.41-1.41a2 2 0 000 2.82L12 32zm20 20l-1.41 1.41a2 2 0 002.82 0L32 52zm20-20l1.41 1.41a2 2 0 000-2.82L52 32zM30.59 10.59l-20 20 2.82 2.82 20-20-2.82-2.82zm-20 22.82l20 20 2.82-2.82-20-20-2.82 2.82zm22.82 20l20-20-2.82-2.82-20 20 2.82 2.82zm20-22.82l-20-20-2.82 2.82 20 20 2.82-2.82zM30 12v40h4V12h-4z",fill:"currentColor"})))};n(15);function p(t,e,n){var a=t[e];return null!=a?a[n]:void 0}function f(t,e,n,a){var r=t[e];null==r&&(t[e]={},r=t[e]);var o=r[n];return r[n]=a,o}function y(t,e){for(var n in t){var a=t[n];for(var r in a){var o=a[r];null!=o&&e(parseInt(n),parseInt(r),o)}}}var m={alpha:{type:"alpha",icon:"alpha",baseColor:"#4791ff"},beta:{type:"beta",icon:"beta",baseColor:"#FFB800"},gamma:{type:"gamma",icon:"gamma",baseColor:"#EB00FF"},delta:{type:"delta",icon:"delta",baseColor:"#00FFC2"}},S=(n(16),n(17),function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).state={visible:!1},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var t=this;window.setTimeout((function(){t.setState({visible:!0})}),100)}},{key:"render",value:function(){var t=this,e=this.props.scale,n={color:this.props.color,height:e,left:this.props.x*e+"px",top:this.props.y*e+"px",width:e},a="#"+this.props.icon,o=["Piece"];return this.state.visible||o.push("hidden"),this.props.selected&&o.push("selected"),this.props.destroyed&&o.push("destroyed"),r.a.createElement("div",{className:o.join(" "),style:n,onMouseDown:function(e){return t.props.actionDown(e.nativeEvent)},onMouseMove:function(e){return t.props.actionMove(e.nativeEvent)},onMouseUp:this.props.actionUp,onTouchStart:function(e){return t.props.actionDown(e.nativeEvent)},onTouchMove:function(e){return t.props.actionMove(e.nativeEvent)},onTouchEnd:this.props.actionUp},r.a.createElement("svg",{width:"64",height:"64",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},r.a.createElement("use",{xlinkHref:a})))}}]),n}(r.a.Component)),b=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(t){var a;return Object(s.a)(this,n),(a=e.call(this,t)).boardRef=void 0,a.boardRef=r.a.createRef(),a.state={lastCoordinates:void 0},a.onStart=a.onStart.bind(Object(l.a)(a)),a.onMove=a.onMove.bind(Object(l.a)(a)),a.onEnd=a.onEnd.bind(Object(l.a)(a)),a}return Object(c.a)(n,[{key:"onStart",value:function(t){if(t instanceof MouseEvent)this.props.onStart(this.toGridSpace(t.clientX,t.clientY));else{var e=t.touches[0];this.props.onStart(this.toGridSpace(e.clientX,e.clientY))}}},{key:"onMove",value:function(t){if(t instanceof MouseEvent)this.setState({lastCoordinates:this.toGridSpace(t.clientX,t.clientY)});else{var e=t.touches[0];this.setState({lastCoordinates:this.toGridSpace(e.clientX,e.clientY)})}}},{key:"onEnd",value:function(){null!=this.state.lastCoordinates&&this.props.onEnd(this.state.lastCoordinates),this.setState({lastCoordinates:void 0})}},{key:"render",value:function(){var t=this,e=-1/0,n=1/0,a=-1/0,o=1/0,i=[];y(this.props.gameState.board,(function(s,c){var l={left:64*s+"px",top:64*c+"px"},u="".concat(s,",").concat(c),d=["Board-cell"];null==p(t.props.gameState.board,s,c-1)&&d.push("Board-entry"),i.push(r.a.createElement("div",{className:d.join(" "),style:l,key:u})),e=Math.max(s,e),a=Math.max(c,a),n=Math.min(s,n),o=Math.min(c,o)}));var s=[],c=function(t,e,n){var a=m[n.type];s.push(r.a.createElement(S,{color:a.baseColor,destroyed:!0,icon:a.icon,id:n.id,key:n.id,scale:64,selected:!1,x:t,y:e,actionDown:function(){},actionMove:function(){},actionUp:function(){}}))};y(this.props.gameState.destroyedThisTick,c),y(this.props.gameState.destroyedLastTick,c),y(this.props.gameState.pieces,(function(e,n,a){var o=m[a.type],i=null!=t.state.lastCoordinates&&t.state.lastCoordinates.x===e&&t.state.lastCoordinates.y===n;s.push(r.a.createElement(S,{color:o.baseColor,destroyed:!1,icon:o.icon,id:a.id,key:a.id,scale:64,selected:i,x:e,y:n,actionDown:t.onStart,actionMove:t.onMove,actionUp:t.onEnd}))}));var l={width:64*(e-n+1)+"px",height:64*(a-o+1)+"px"};return r.a.createElement("div",{className:"Board",ref:this.boardRef,style:l},r.a.createElement("div",{className:"Board-grid"},i),r.a.createElement("div",{className:"Board-pieces"},s))}},{key:"toGridSpace",value:function(t,e){var n,a=null===(n=this.boardRef.current)||void 0===n?void 0:n.getBoundingClientRect(),r=null===a||void 0===a?void 0:a.left;if(null==r)throw Error("Could not get left of board ref!");var o=null===a||void 0===a?void 0:a.top;if(null==o)throw Error("Could not get top of board ref!");return{x:Math.floor((t-r)/64),y:Math.floor((e-o)/64)}}}]),n}(r.a.Component),g=function(){function t(e,n,a,r){Object(s.a)(this,t),this.currentState=void 0,this.generator=void 0,this.allowedMoves=void 0,this.matchRules=void 0,this.currentState=e,this.generator=n,this.allowedMoves=a,this.matchRules=r.sort((function(t,e){return e.priority-t.priority}))}return Object(c.a)(t,[{key:"initialize",value:function(){for(console.time();!this.currentState.settled;)this.tick();this.currentState.score=0,this.currentState.destroyedThisTick=[],console.timeEnd()}},{key:"move",value:function(t,e){var n=this;return!(!0!==this.currentState.settled||!this.allowedMoves.some((function(a){return a(t,e,n.currentState)})))&&(function(t,e,n,a,r){var o=p(t,e,n);f(t,e,n,p(t,a,r)),f(t,a,r,o)}(this.currentState.pieces,t.x,t.y,e.x,e.y),this.currentState.settled=!1,!0)}},{key:"tick",value:function(){var t=this,e=this.state,n=JSON.stringify(e),a=this.state,r=!0;a.destroyedLastTick=a.destroyedThisTick,a.destroyedThisTick=[];var o={};return y(a.board,(function(t,e){if(null==p(a.pieces,t,e))for(;null!=p(a.board,t,e);)f(o,t,e,!0),e-=1})),y(o,(function(n,o){null!=p(a.board,n,o-1)?f(a.pieces,n,o,p(e.pieces,n,o-1)):f(a.pieces,n,o,t.generator({x:n,y:o})),r=!1})),r&&this.matchRules.forEach((function(t){JSON.stringify(a);a=t.apply(a),JSON.stringify(a)})),a.settled=JSON.stringify(a)===n,this.currentState=a,Object.assign({},this.currentState)}},{key:"state",get:function(){return JSON.parse(JSON.stringify(this.currentState))}}]),t}(),w=n(20),k=Object.keys(m),E=function(){var t=Math.floor(Math.random()*k.length);return{id:Object(w.a)(),type:k[t]}},x=[function(t,e,n){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)===1&&(null!=p(n.pieces,t.x,t.y)&&null!=p(n.pieces,e.x,e.y))}],M=n(6);function O(t,e){for(var n=arguments.length,a=new Array(n>2?n-2:0),r=2;r<n;r++)a[r-2]=arguments[r];var o=t.pieces;return y(t.board,(function(n,r){var i=p(o,n,r);if(null!=i){var s,c=i.type,l=Object(M.a)(a);try{for(l.s();!(s=l.n()).done;){var u=s.value,d=p(o,n+u.x,r+u.y);if(null==d||d.type!==c)return}}catch(S){l.e(S)}finally{l.f()}var h,v=Object(M.a)(a);try{for(v.s();!(h=v.n()).done;){var y=h.value,m=f(t.pieces,n+y.x,r+y.y,void 0);f(t.destroyedThisTick,n+y.x,r+y.y,m)}}catch(S){v.e(S)}finally{v.f()}t.score+=e}})),t}var C=[{priority:.1,apply:function(t){return O(t,300,{x:-3,y:0},{x:-2,y:0},{x:-1,y:0},{x:0,y:0}),t}},{priority:.1,apply:function(t){return O(t,300,{x:0,y:-3},{x:0,y:-2},{x:0,y:-1},{x:0,y:0}),t}},{priority:0,apply:function(t){return O(t,100,{x:-2,y:0},{x:-1,y:0},{x:0,y:0}),t}},{priority:0,apply:function(t){return O(t,100,{x:0,y:-2},{x:0,y:-1},{x:0,y:0}),t}}],j=function(t){Object(d.a)(n,t);var e=Object(u.a)(n);function n(t){var a;Object(s.a)(this,n),(a=e.call(this,t)).interval=0;var r=new g({board:{0:{1:!0,2:!0,3:!0},1:{0:!0,1:!0,2:!0,3:!0,4:!0},2:{0:!0,1:!0,2:!0,3:!0,4:!0},3:{0:!0,1:!0,2:!0,3:!0,4:!0},4:{1:!0,2:!0,3:!0}},score:0,pieces:[],destroyedThisTick:[],destroyedLastTick:[],settled:!1},E,x,C);return r.initialize(),a.state={engine:r,gameState:r.state,start:void 0,score:r.state.score},a.onStart=a.onStart.bind(Object(l.a)(a)),a.onEnd=a.onEnd.bind(Object(l.a)(a)),a}return Object(c.a)(n,[{key:"onStart",value:function(t){return this.setState({start:t}),!1}},{key:"onEnd",value:function(t){var e=this,n=this.state.engine;if(null!=t&&null!=this.state.start&&n.state.settled&&n.move(this.state.start,t)){this.setState({gameState:n.tick()}),this.targetScore(n.state.score);var a=window.setInterval((function(){e.setState({gameState:n.tick()}),e.targetScore(n.state.score),e.forceUpdate(),e.state.gameState.settled&&window.clearInterval(a)}),150)}return this.setState({start:void 0}),!1}},{key:"targetScore",value:function(t){var e=this;window.clearInterval(this.interval);var n=(new Date).getTime(),a=this.state.score,r=window.setInterval((function(){var o=((new Date).getTime()-n)/1e3;if(o>1)return e.setState({score:t}),void window.clearInterval(r);e.setState({score:Math.floor(e.easeOutCirc(o,a,t-a))})}),10);this.interval=r}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(v,null),r.a.createElement("div",{className:"score"},this.state.score),r.a.createElement(b,{gameState:this.state.gameState,onStart:this.onStart,onEnd:this.onEnd}))}},{key:"easeOutCirc",value:function(t,e,n){return t--,n*Math.sqrt(1-t*t)+e}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.4811ec51.chunk.js.map