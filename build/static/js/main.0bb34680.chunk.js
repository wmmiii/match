(this.webpackJsonpmatch=this.webpackJsonpmatch||[]).push([[0],[,,,,,,,,,function(t,e,a){t.exports=a(19)},,,,,function(t,e,a){},function(t,e,a){},function(t,e,a){},function(t,e,a){},function(t,e,a){},function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(8),o=a.n(i),s=(a(14),a(1)),c=a(2),l=a(4),u=a(5),d=a(3);a(15);function h(t,e,a){var n=t[e];return null!=n?n[a]:void 0}function p(t,e,a,n){var r=t[e];null==r&&(t[e]={},r=t[e]);var i=r[a];return r[a]=n,i}function v(t,e){for(var a in t){var n=t[a];for(var r in n){var i=n[r];null!=i&&e(parseInt(a),parseInt(r),i)}}}var f={alpha:{type:"alpha",icon:"alpha",baseColor:"#4791ff"},beta:{type:"beta",icon:"beta",baseColor:"#FFB800"},gamma:{type:"gamma",icon:"gamma",baseColor:"#EB00FF"},delta:{type:"delta",icon:"delta",baseColor:"#00FFC2"}},m=(a(16),a(17),function(t){Object(u.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(s.a)(this,a),(n=e.call(this,t)).state={visible:!1},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var t=this;window.setTimeout((function(){t.setState({visible:!0})}),100)}},{key:"render",value:function(){var t=this,e=this.props.scale,a={color:this.props.color,height:e,left:this.props.x*e+"px",top:this.props.y*e+"px",width:e},n="#"+this.props.icon,i=["Piece"];return this.state.visible||i.push("hidden"),this.props.selected&&i.push("selected"),this.props.destroyed&&i.push("destroyed"),r.a.createElement("div",{className:i.join(" "),style:a,onMouseDown:function(e){return t.props.actionDown(e.nativeEvent)},onMouseMove:function(e){return t.props.actionMove(e.nativeEvent)},onMouseUp:this.props.actionUp,onTouchStart:function(e){return t.props.actionDown(e.nativeEvent)},onTouchMove:function(e){return t.props.actionMove(e.nativeEvent)},onTouchEnd:this.props.actionUp},r.a.createElement("svg",{width:"64",height:"64",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64"},r.a.createElement("use",{xlinkHref:n})))}}]),a}(r.a.Component)),y=function(t){Object(u.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(s.a)(this,a),(n=e.call(this,t)).boardRef=void 0,n.boardRef=r.a.createRef(),n.state={lastCoordinates:void 0},n.onStart=n.onStart.bind(Object(d.a)(n)),n.onMove=n.onMove.bind(Object(d.a)(n)),n.onEnd=n.onEnd.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"onStart",value:function(t){if(t instanceof MouseEvent)this.props.onStart(this.toGridSpace(t.clientX,t.clientY));else{var e=t.touches[0];this.props.onStart(this.toGridSpace(e.clientX,e.clientY))}}},{key:"onMove",value:function(t){if(t instanceof MouseEvent)this.setState({lastCoordinates:this.toGridSpace(t.clientX,t.clientY)});else{var e=t.touches[0];this.setState({lastCoordinates:this.toGridSpace(e.clientX,e.clientY)})}}},{key:"onEnd",value:function(){null!=this.state.lastCoordinates&&this.props.onEnd(this.state.lastCoordinates),this.setState({lastCoordinates:void 0})}},{key:"render",value:function(){var t=this,e=-1/0,a=1/0,n=-1/0,i=1/0,o=[];v(this.props.gameState.board,(function(s,c){var l={left:64*s+"px",top:64*c+"px"},u="".concat(s,",").concat(c),d=["Board-cell"];null==h(t.props.gameState.board,s,c-1)&&d.push("Board-entry"),o.push(r.a.createElement("div",{className:d.join(" "),style:l,key:u})),e=Math.max(s,e),n=Math.max(c,n),a=Math.min(s,a),i=Math.min(c,i)}));var s=[],c=function(t,e,a){var n=f[a.type];s.push(r.a.createElement(m,{color:n.baseColor,destroyed:!0,icon:n.icon,id:a.id,key:a.id,scale:64,selected:!1,x:t,y:e,actionDown:function(){},actionMove:function(){},actionUp:function(){}}))};v(this.props.gameState.destroyedThisTick,c),v(this.props.gameState.destroyedLastTick,c),v(this.props.gameState.pieces,(function(e,a,n){var i=f[n.type],o=null!=t.state.lastCoordinates&&t.state.lastCoordinates.x===e&&t.state.lastCoordinates.y===a;s.push(r.a.createElement(m,{color:i.baseColor,destroyed:!1,icon:i.icon,id:n.id,key:n.id,scale:64,selected:o,x:e,y:a,actionDown:t.onStart,actionMove:t.onMove,actionUp:t.onEnd}))}));var l={width:64*(e-a+1)+"px",height:64*(n-i+1)+"px"};return r.a.createElement("div",{className:"Board",ref:this.boardRef,style:l},r.a.createElement("div",{className:"Board-grid"},o),r.a.createElement("div",{className:"Board-pieces"},s))}},{key:"toGridSpace",value:function(t,e){var a,n=null===(a=this.boardRef.current)||void 0===a?void 0:a.getBoundingClientRect(),r=null===n||void 0===n?void 0:n.left;if(null==r)throw Error("Could not get left of board ref!");var i=null===n||void 0===n?void 0:n.top;if(null==i)throw Error("Could not get top of board ref!");return{x:Math.floor((t-r)/64),y:Math.floor((e-i)/64)}}}]),a}(r.a.Component),b=function(){function t(e,a,n,r){Object(s.a)(this,t),this.currentState=void 0,this.generator=void 0,this.allowedMoves=void 0,this.matchRules=void 0,this.currentState=e,this.generator=a,this.allowedMoves=n,this.matchRules=r.sort((function(t,e){return e.priority-t.priority}))}return Object(c.a)(t,[{key:"initialize",value:function(){for(console.time();!this.currentState.settled;)this.tick();this.currentState.totalScore=0,this.currentState.score=0,this.currentState.multiplier=0,this.currentState.destroyedThisTick=[],console.timeEnd()}},{key:"move",value:function(t,e){var a=this;return!(!0!==this.currentState.settled||!this.allowedMoves.some((function(n){return n(t,e,a.currentState)})))&&(function(t,e,a,n,r){var i=h(t,e,a);p(t,e,a,h(t,n,r)),p(t,n,r,i)}(this.currentState.pieces,t.x,t.y,e.x,e.y),this.currentState.settled=!1,!0)}},{key:"tick",value:function(){var t=this,e=this.state,a=JSON.stringify(e),n=this.state,r=!0;n.destroyedLastTick=n.destroyedThisTick,n.destroyedThisTick=[];var i={};return v(n.board,(function(t,e){if(null==h(n.pieces,t,e))for(;null!=h(n.board,t,e);)p(i,t,e,!0),e-=1})),v(i,(function(a,i){null!=h(n.board,a,i-1)?p(n.pieces,a,i,h(e.pieces,a,i-1)):p(n.pieces,a,i,t.generator({x:a,y:i})),r=!1})),r&&this.matchRules.forEach((function(t){JSON.stringify(n);n=t.apply(n),JSON.stringify(n)})),n.settled=JSON.stringify(n)===a,n.settled&&(n.totalScore+=n.score*n.multiplier,n.score=0,n.multiplier=0),this.currentState=n,Object.assign({},this.currentState)}},{key:"state",get:function(){return JSON.parse(JSON.stringify(this.currentState))}}]),t}(),S=a(21),g=Object.keys(f),E=function(){var t=Math.floor(Math.random()*g.length);return{id:Object(S.a)(),type:g[t]}},x=[function(t,e,a){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)===1&&(null!=h(a.pieces,t.x,t.y)&&null!=h(a.pieces,e.x,e.y))}],w=a(6);function k(t,e){for(var a=arguments.length,n=new Array(a>2?a-2:0),r=2;r<a;r++)n[r-2]=arguments[r];var i=t.pieces;return v(t.board,(function(a,r){var o=h(i,a,r);if(null!=o){var s,c=o.type,l=Object(w.a)(n);try{for(l.s();!(s=l.n()).done;){var u=s.value,d=h(i,a+u.x,r+u.y);if(null==d||d.type!==c)return}}catch(b){l.e(b)}finally{l.f()}var v,f=Object(w.a)(n);try{for(f.s();!(v=f.n()).done;){var m=v.value,y=p(t.pieces,a+m.x,r+m.y,void 0);p(t.destroyedThisTick,a+m.x,r+m.y,y)}}catch(b){f.e(b)}finally{f.f()}t.score+=e,t.multiplier+=1}})),t}var M=[{priority:.2,apply:function(t){return k(t,500,{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0},{x:0,y:0}),t}},{priority:.2,apply:function(t){return k(t,500,{x:0,y:-4},{x:0,y:-3},{x:0,y:-2},{x:0,y:-1},{x:0,y:0}),t}},{priority:.1,apply:function(t){return k(t,300,{x:-3,y:0},{x:-2,y:0},{x:-1,y:0},{x:0,y:0}),t}},{priority:.1,apply:function(t){return k(t,300,{x:0,y:-3},{x:0,y:-2},{x:0,y:-1},{x:0,y:0}),t}},{priority:0,apply:function(t){return k(t,100,{x:-2,y:0},{x:-1,y:0},{x:0,y:0}),t}},{priority:0,apply:function(t){return k(t,100,{x:0,y:-2},{x:0,y:-1},{x:0,y:0}),t}}],O=function(t){Object(u.a)(a,t);var e=Object(l.a)(a);function a(t){var n;Object(s.a)(this,a),(n=e.call(this,t)).lastNumber=new Map,n.aBlipRef=void 0,n.amBlipRef=void 0,n.emBlipRef=void 0,n.gmBlipRef=void 0;var i=new b({board:{0:{1:!0,2:!0,3:!0},1:{0:!0,1:!0,2:!0,3:!0,4:!0},2:{0:!0,1:!0,2:!0,3:!0,4:!0},3:{0:!0,1:!0,2:!0,3:!0,4:!0},4:{1:!0,2:!0,3:!0}},totalScore:0,score:0,multiplier:0,pieces:[],destroyedThisTick:[],destroyedLastTick:[],settled:!1},E,x,M);return i.initialize(),n.aBlipRef=r.a.createRef(),n.amBlipRef=r.a.createRef(),n.emBlipRef=r.a.createRef(),n.gmBlipRef=r.a.createRef(),n.state={engine:i,gameState:i.state,start:void 0,totalScore:i.state.totalScore,score:i.state.score,multiplier:i.state.multiplier},n.onStart=n.onStart.bind(Object(d.a)(n)),n.onEnd=n.onEnd.bind(Object(d.a)(n)),n}return Object(c.a)(a,[{key:"onStart",value:function(t){return this.setState({start:t}),!1}},{key:"onEnd",value:function(t){var e=this,a=this.state.engine;if(null!=t&&null!=this.state.start&&a.state.settled&&a.move(this.state.start,t)){this.update(a.tick());var n=window.setInterval((function(){e.update(a.tick()),e.state.gameState.settled&&window.clearInterval(n)}),150)}return this.setState({start:void 0}),!1}},{key:"update",value:function(t){var e=[this.aBlipRef,this.amBlipRef,this.emBlipRef,this.gmBlipRef],a=0;v(t.destroyedThisTick,(function(){a++,window.setTimeout((function(){var t=Math.floor(Math.random()*e.length),n=e[t];if(null!=n&&null!=n.current){var r=n.current.cloneNode(!0);r.volume=1/a,r.play()}}),40*a)})),this.setState({gameState:t,multiplier:t.multiplier}),this.targetNumber("totalScore",t.totalScore,2e3),0!==t.score?this.targetNumber("score",t.score,200):(this.setState({score:0}),this.lastNumber.set("score",0))}},{key:"targetNumber",value:function(t,e,a){var n=this;if(this.lastNumber.get(t)!==e){var r=(new Date).getTime(),i=this.state[t];window.requestAnimationFrame((function o(){if(n.lastNumber.get(t)===e){var s=((new Date).getTime()-r)/a;if(s>1){var c={};return c[t]=e,void n.setState(c)}var l={};l[t]=Math.floor(n.easeOutCirc(s,i,e-i)),n.setState(l),window.requestAnimationFrame(o)}})),this.lastNumber.set(t,e)}}},{key:"render",value:function(){return r.a.createElement("div",{className:"Game"},r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"score"},this.state.totalScore),r.a.createElement("div",{className:"space"}),r.a.createElement("div",{className:"score"},this.state.score),r.a.createElement("div",{className:"spacer"}),r.a.createElement("div",{className:"score"},"x",this.state.multiplier)),r.a.createElement(y,{gameState:this.state.gameState,onStart:this.onStart,onEnd:this.onEnd}),r.a.createElement("audio",{ref:this.aBlipRef,src:"aBlip.wav"}),r.a.createElement("audio",{ref:this.amBlipRef,src:"amBlip.wav"}),r.a.createElement("audio",{ref:this.emBlipRef,src:"emBlip.wav"}),r.a.createElement("audio",{ref:this.gmBlipRef,src:"gmBlip.wav"}))}},{key:"easeOutCirc",value:function(t,e,a){return t--,a*Math.sqrt(1-t*t)+e}}]),a}(r.a.Component),j=(a(18),{display:"none"}),B=function(){return r.a.createElement("svg",{width:"64",height:"64",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:j},r.a.createElement("defs",null,r.a.createElement("g",{id:"alpha",fill:"none"},r.a.createElement("circle",{cx:"32",cy:"32",r:"24",stroke:"currentColor",strokeWidth:"4"}),r.a.createElement("circle",{cx:"32",cy:"32",r:"16",stroke:"currentColor",strokeWidth:"4"})),r.a.createElement("path",{id:"beta",d:"M48 12L16 52h32L16 12h32z",fill:"none",stroke:"currentColor",strokeWidth:"4",strokeLinecap:"round",strokeLinejoin:"round"}),r.a.createElement("path",{id:"gamma",d:"M34 16a2 2 0 10-4 0h4zM8 38a2 2 0 100 4v-4zm48 4a2 2 0 100-4v4zm-5.59-17.59a2 2 0 10-2.82-2.82l2.82 2.82zm-34-2.82a2 2 0 10-2.82 2.82l2.82-2.82zM8 42h24v-4H8v4zm24 0h24v-4H32v4zm0-16c3.87 0 7.36 1.56 9.9 4.1l2.83-2.83A17.95 17.95 0 0032 22v4zm9.9 4.1A13.95 13.95 0 0146 40h4c0-4.97-2.02-9.47-5.27-12.73L41.9 30.1zm2.83 0l5.68-5.69-2.82-2.82-5.69 5.68 2.83 2.83zM18 40c0-3.87 1.56-7.36 4.1-9.9l-2.83-2.83A17.95 17.95 0 0014 40h4zm4.1-9.9A13.95 13.95 0 0132 26v-4c-4.97 0-9.47 2.02-12.73 5.27l2.83 2.83zm0-2.83l-5.69-5.68-2.82 2.82 5.68 5.69 2.83-2.83zM34 24v-8h-4v8h4z",fill:"currentColor"}),r.a.createElement("path",{id:"delta",d:"M32 12l1.41-1.41a2 2 0 00-2.82 0L32 12zM12 32l-1.41-1.41a2 2 0 000 2.82L12 32zm20 20l-1.41 1.41a2 2 0 002.82 0L32 52zm20-20l1.41 1.41a2 2 0 000-2.82L52 32zM30.59 10.59l-20 20 2.82 2.82 20-20-2.82-2.82zm-20 22.82l20 20 2.82-2.82-20-20-2.82 2.82zm22.82 20l20-20-2.82-2.82-20 20 2.82 2.82zm20-22.82l-20-20-2.82 2.82 20 20 2.82-2.82zM30 12v40h4V12h-4z",fill:"currentColor"})))},C=function(t){Object(u.a)(a,t);var e=Object(l.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(B,null),r.a.createElement(O,null))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(C,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.0bb34680.chunk.js.map